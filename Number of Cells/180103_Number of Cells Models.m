%% Model and Code to Determine the Maximum number of cells stimulateable in one second
% This Code is associated with the supplement to:
% Precise multimodal optical control of neural ensemble activity
% Mardinly, Oldenburg, Pegard, et al Nature Neuroscience 2018
% 
% This code written by Ian Oldenburg, contact: ian.oldenburg@gmail.com
% Jan 3, 2018
%
% We specifically Modeled 3 SLMs used in our setups, a 512x512 pixel 
% Meadowlark, a 1920x1024 pixel Meadowlark, and 800x600 pixel Hammamatsu. 
%


%% 1.1 Basic Parameters
% Model 4 Different SLMs distinguished by their rise and fall time. (aka
% the time necessary for a pixel to transition from rest to a maximal phase
% or back). To include another SLM, simply add its rise and fall time to
% 'riseTime' and 'fallTime'.

dur = 1:0.01:15; %stimulus durrations modeled in ms
colors={[0 0 0] [0 0 0.8] [0 0.4 0] [1 0.5 0]};%rgb('black') rgb('MediumBlue') rgb('DarkGreen') rgb('DarkOrange')};
riseTime=[0 1.86 2.7 10]; % Rise time as reported by manufacturer, also confirmed empirically. manufacturer switch times ignores driver delays etc
fallTime = [0 1.55 2.3 80]; %in ms
deadTime = riseTime + fallTime;
powerPerTarget = 60; %mW fuzzy number we use 0.2mW/um2 or 50-75mW per target
TotalLaserPower = 4100; %mW measured total output of laser

maxEfficiency = 31/35; %in vivo fraction spikeable from figure 1L. This will be opsin dependent but just scales the total number of cells.
%% 1.2 Calculate the Maximal stimulation rate for each SLM.
stimRate = 1000./(deadTime+5);
disp(['Stim Rate for 5ms pulse: ' num2str(1000./(deadTime+5))])

%% 1.3 Determine the Efficiency for each SLM based on the number of holograms simultaneously Addressed

%The diffraction efficiency function is determined based on the empirically
%measured efficiency of a single spot throughout the addressable range. The
%efficicency of multiple spots is simulated from this primary data, an
%example of this calibration is provided in section 1.9

LDmedDE = [83.0984519555215,83.0973234565605,83.0957055833712,83.0930019995237,83.0849706743351,83.0781501879901,83.0713755008806,83.0597654278737,83.0578158369342,83.0386623509320,83.0322786020207,83.0213696030891,83.0063789476220,82.9901780021842,82.9736992814986,82.9593878949913,82.9347996927303,82.9243090683461,82.8923949428514,82.8757052939971,82.8639842112097,82.8415211970457,82.8182299434756,82.7819532588224,82.7580367043174,82.7265793994010,82.7086027318466,82.6699149404790,82.6382594944868,82.6059743973122,82.5789486172145,82.5353057238094,82.4995660347527,82.4688415251511,82.4324760843997,82.3791611224434,82.3470783396323,82.3082789045675,82.2675356009644,82.2391857178292,82.1705643531429,82.1256242936988,82.0916289007264,82.0277123041945,81.9853902284469,81.9238953541205,81.8879956640424,81.8293637201460,81.7771041010145,81.7110204255307,81.6587787468437,81.6140772395645,81.5473914519858,81.4934050127086,81.4337548705950,81.3617790746010,81.3047907702305,81.2370808741413,81.1696675706135,81.1091714637295,81.0468028579349,80.9806383779211,80.9130021173429,80.8329398307686,80.7648045281792,80.6969527714664,80.6219868916513,80.5401648838117,80.4554119662001,80.3969916551552,80.3029547541495,80.2254614944867,80.1515527458121,80.0683093996247,79.9786207348881,79.9031347582356,79.8038009283451,79.7275034391723,79.6287265577362,79.5331280250552,79.4463872038022,79.3486975934439,79.2550398117451,79.1706262874168,79.0620845632537,78.9825866878448,78.8762367561922,78.7694086198579,78.6616130199521,78.5749558475952,78.4874121871729,78.3679698992060,78.2622756536802,78.1550976589616,78.0376000240990,77.9325141637793,77.8287997230478,77.7209290479221,77.5979017191282,77.4895771258316,77.3800922222778,77.2388092302863,77.1437595646348,77.0101741677427,76.8777143119945,76.7766247758460,76.6526346204112,76.4987456127725,76.3910841759369,76.2399584585006,76.1093837688805,75.9714808512189,75.8465587359923,75.7246584356481,75.5716905679719,75.4582175810321,75.3018948858505,75.1748035337133,75.0420736899789,74.9038647692371,74.7156196649293,74.6151161679498,74.4315404315146,74.3232252875452,74.1673920409003,74.0087474711349,73.8305537577962,73.7203277796163,73.5455968242758,73.3919613013182,73.2365897506756,73.0646750354154,72.8925540019708,72.7406104670245,72.5494273307388,72.3727005035678,72.2578504007126,72.0247588909359,71.9007332934974,71.6566261771315,71.5918024745254,71.3767408676636,71.1786894343759,70.9848887987445,70.7802197742887,70.6063584515016,70.4624990777378,70.2759582311128,70.0526920909973,69.9101483319179,69.7002081486137,69.4526941209708,69.3226313044670,69.0946828057854,68.8839372443554,68.7130227982706,68.5060345573035,68.2615882191536,68.0611249531165,67.8736871239846,67.6766864398531,67.4107818239576,67.2392351836443,67.0090183153841,66.8218132779711,66.5302511594571,66.2461112788665,66.0728755333415,65.8818015578681,65.5653207337112,65.3782251777849,65.1494331645137,64.9621742649547,64.6780773398514,64.4572959429676,64.1935592670886,63.9276686621424,63.6937606690824,63.3875609293042,63.1531697714725,62.8448170250665,62.6192337750933,62.3286353516486,62.0498960839335,61.7695788578516,61.4839421033040,61.2309054675247,60.9748940762328,60.6133957913475,60.3134798500782,60.0421614890144,59.7554343209052,59.3933786228106,59.1484748939690,58.8170809527133,58.4222263554371,58.1178740659149,57.7722951427456,57.5230788773196,57.2259378291986];
HDmedDE = [77.8962314221471,77.8912734144005,77.8913129733781,77.8939700660624,77.8912479108680,77.8846817239257,77.8801270094914,77.8779439976064,77.8695775771525,77.8567486027105,77.8679226802990,77.8477989237287,77.8427693771314,77.8224552011077,77.8134880550477,77.8069339266958,77.8043268633285,77.7707598217789,77.7661757256085,77.7554440921988,77.7514146263960,77.7359104042429,77.7321135447245,77.6972426310336,77.6780600650340,77.6607288288925,77.6610195792971,77.6294856910885,77.6005771876408,77.5828857276987,77.5775096314043,77.5529930273112,77.5372821722266,77.4940010223264,77.4626310899100,77.4593729182732,77.4159092942946,77.4086342788065,77.3648940642303,77.3595707859341,77.2991151566423,77.2894296422991,77.2551464457144,77.2262796935106,77.2021468079871,77.1628811677067,77.1308236990081,77.1092229129776,77.0699780878763,77.0535513919529,77.0057569311377,76.9725920365105,76.9075539184533,76.9070007387397,76.8662766543708,76.8090403126678,76.7489987374704,76.7393960934279,76.6704890195526,76.6616129089440,76.6091195150228,76.5561129905387,76.5173250430019,76.4611462948327,76.4093834113430,76.3700092266463,76.3565459438838,76.2995826326693,76.2267410787113,76.2142183768435,76.1392916186998,76.0837515078604,76.0333947123374,75.9847093334566,75.9442721447078,75.8656948965221,75.8282746910346,75.7829116207112,75.7152678693137,75.6549035238576,75.6203649381535,75.5432584021788,75.5094104189272,75.4315269039568,75.4197643384488,75.2885663933202,75.2667612453674,75.1792474895534,75.1163823404098,75.0637711749519,74.9840286994692,74.9234909276150,74.8711531214604,74.8038649501811,74.7296409294818,74.6757659300706,74.6006447430533,74.5051426686887,74.4632982516119,74.3874311922029,74.3409844172786,74.2833191166511,74.1738567287873,74.1236048957996,74.0224344110964,73.9728818662960,73.8565066816258,73.8221351495207,73.7241424181198,73.6406604630957,73.5244459958928,73.4564583953771,73.4331974176624,73.2904251055174,73.2340728611453,73.1576323337789,73.0648354074523,72.9916107487699,72.8856305242517,72.8131235443961,72.7444420214076,72.6310842584144,72.5326724180539,72.4372079037777,72.3522474844123,72.2845224961291,72.2072483025992,72.1234572248730,71.9827359051837,71.8892284739260,71.7924384857175,71.7069088597266,71.6094957179949,71.5342123190401,71.4088853512198,71.3555930367423,71.2146711908326,71.1357036121574,70.9692591561934,70.9294458470414,70.7886472040776,70.7041336159451,70.6108018613271,70.5147728099345,70.3957092125151,70.2706398650780,70.1034452767833,70.0872522444334,69.9533630106524,69.8370521160358,69.7224959189274,69.6094392246242,69.4912587109672,69.3888387597439,69.2660321127553,69.1384795758158,69.0382228955292,68.9322203263834,68.7996575131795,68.7159054338069,68.5352709663159,68.4273307456451,68.3013043444410,68.2157016036612,68.0203782583754,67.9363459993559,67.8122737267637,67.6950564406040,67.5613740263064,67.3953127482650,67.3401456022029,67.1275891946018,67.0529357340194,66.8660298070006,66.7122076444273,66.6531016227200,66.4806104572915,66.3517629548083,66.2427490960932,66.0745736993692,65.9628622489156,65.7735169558198,65.6614722966497,65.4974925792562,65.3653778727596,65.1994179196102,65.1102127674515,64.9196872955922,64.7436380176908,64.6156166591885,64.4764210349964,64.3679637680554,64.1393121851403,64.0320163775207,63.8983590656118,63.6934930543377,63.5129137055239,63.3249437107480,63.2550637471404,63.0329159988474];
HamDE = [83.6000280951584,83.5986616355086,83.5950499518902,83.5929446256185,83.5935283757547,83.5894401253735,83.5866647319313,83.5820848541910,83.5752557818151,83.5704972398808,83.5601987939890,83.5513699252186,83.5458311848618,83.5393533542649,83.5301704975044,83.5222732828575,83.5062414624357,83.4955930423062,83.4839453938172,83.4779977840801,83.4680749651222,83.4500723860360,83.4328022590096,83.4209597460107,83.3981786400804,83.3983007747961,83.3664098753359,83.3487817987188,83.3332851500201,83.3146241199630,83.2991315554641,83.2769536724959,83.2582345145638,83.2360146721894,83.2114081692676,83.1913586251416,83.1763791262243,83.1371762865375,83.1172871364815,83.0933610429110,83.0645844486351,83.0374397609780,83.0156005569508,82.9757797299463,82.9602446442667,82.9273248122717,82.9000539712983,82.8727584361997,82.8325417885551,82.8111000235063,82.7800885953265,82.7557264699128,82.7182315148170,82.6766819756879,82.6430364005701,82.6161049252523,82.5616293355485,82.5359977666990,82.4987034342543,82.4589491201153,82.4167072890421,82.3803406755632,82.3377801902692,82.3044446142605,82.2677675524523,82.2191946575336,82.1754506406866,82.1351548664360,82.0868257366237,82.0401058170518,81.9958408330333,81.9502226354048,81.9091786923820,81.8568554587278,81.8065595918972,81.7543257684907,81.7228843040872,81.6586130806561,81.6141500844836,81.5595348427465,81.5104069299111,81.4600440670525,81.4123352220504,81.3405626232763,81.2973372078465,81.2350847002974,81.1804587070702,81.1238670054050,81.0673663450751,81.0018927155317,80.9637127036567,80.9073232456946,80.8480063280452,80.7918748374366,80.7106443804057,80.6515448523472,80.6020190458645,80.5182527581891,80.4550064728135,80.4007089711408,80.3281079344981,80.2614985750929,80.1949235321064,80.1264385198460,80.0498337076001,79.9999855194452,79.9233954620267,79.8583282697220,79.7831572294891,79.7047998199210,79.6301176634664,79.5638244221410,79.5033076578023,79.4275075517052,79.3186840151065,79.2509917341901,79.1919886706357,79.1200334507827,79.0467008522599,78.9767277203476,78.8542694744695,78.8080547589978,78.7184831613769,78.6319345851672,78.5517191481298,78.4619882551430,78.3822711810296,78.3061048487628,78.2035610749292,78.1239715867234,78.0281216983963,77.9625392775315,77.8756614621934,77.7674409854886,77.6663962376792,77.5954598073405,77.5101063739985,77.3953295325244,77.2996997692940,77.2467136560002,77.1214986264608,77.0198315407057,76.9307774128812,76.8355823667567,76.7383920401348,76.6205051774628,76.5218987973613,76.4450677523413,76.3526845533889,76.2340990863625,76.1092709516760,76.0471383460103,75.9430124162782,75.8275066988986,75.6998361246920,75.6148127378102,75.4764833930996,75.3780099454743,75.2763759470141,75.1788400379241,75.0647197537711,74.9477465248051,74.8524984913592,74.7246463528122,74.6252513285181,74.5001548918813,74.3981465764340,74.2417047500770,74.1828260805442,74.0665302342039,73.8964888923786,73.7852977438224,73.6741307796382,73.5589872826633,73.4078548798901,73.2532842491730,73.1749548037041,72.9939947969802,72.9036541903318,72.7902940440276,72.6939068429416,72.5485636516061,72.3997278023429,72.2711023504735,72.1192456936150,71.9924796051465,71.8554788237115,71.7410265308465,71.6017740248765,71.5060139608251,71.3154912815337,71.1864648099180,71.0439419632209,70.9317376172755,70.7421911622170,70.5983880262074,70.4711012501699,70.3386853158589,70.2003511042843,70.0293826212834];

figure(100);clf
hold on
plot(LDmedDE,'LineWidth',2','color',colors{2})
plot(HDmedDE,'LineWidth',2','color',colors{3})
plot(HamDE,'LineWidth',2','color',colors{4})
xlim([0 200])
ylim([0 100])
ylabel('Diffraction Efficiency')
xlabel('Number of Targets')

%diffraction efficiency for a 50 target hologram for each of the three
%SLMs.
DE50 = [1 LDmedDE(50)/100 HDmedDE(50)/100  HamDE(50)/100];

maxHoloPerFrame = floor(TotalLaserPower/powerPerTarget*DE50); %As the diffraction efficiency between 50 and 70 holograms is about the same, we use the 50 Hologram diffraction efficiency
disp(['Total Holos per frame: ' num2str( TotalLaserPower/powerPerTarget*DE50)]);

disp(['Total Holos per second: ' num2str(maxHoloPerFrame .* stimRate*maxEfficiency)]);
%% 1.4 Based on our Measured Spike Latencies, How many spikes could be stimulated per second
st = [1.97390000000000;4.78240000000000;4.32670000000000;1.98300000000000;6.04040000000000;3.78640000000000;3.31670000000000;2.60910000000000;6.77500000000000;2.20000000000000;2.01250000000000;2;4.45000000000000;2.93854166700000;1.99500000000000;3.24375000000000;2.64194444400000;4.65069444400000;4.38833333300000;4.11500000000000;4.66111111100000;2.05000000000000;1.80000000000000;4.60666666700000;4.42750000000000;3.75000000000000;3.35000000000000;2.05000000000000;1.80000000000000];
%spike times combined from in vitro and in vivo recordings.


pSpike=sum((st<dur))./numel(st) * maxEfficiency; %probability of spiking, scaled by max efficiency
%Note this 'probability' is actually the rate in which the spike latency
%was less than the stimulus duration, and thus by definition lower than the
%true probability of spiking a cell with a given stimulus. 

figure(101);clf
subplot(1,2,1)
plot(dur,pSpike,'color','k','LineWidth',2);
xlabel('Stim Duration (ms)')
ylabel('Probability of Spiking')
ylim([0 1])

subplot(1,2,2)
hold on
for i=1:numel(deadTime)
    numHolosPerFrame=TotalLaserPower/powerPerTarget*DE50(i);
    plot(dur,1000./(dur+deadTime(i)).*pSpike*numHolosPerFrame,'color',colors{i},'LineWidth',2)
end
xlabel('Stim Duration (ms)')
ylabel('Number of Spikeable Targets in 1 Second')

%% 1.4 Smoothed Modeled spiking probability from our data

LatM = mean(st); %mean spike latency
LatSTD = std(st); %standard deviation spike latency

stDist = LatSTD.*randn(100000,1)+LatM; %distribution of spike latency from above

pSpikeDist=sum((stDist<dur))./numel(stDist) * maxEfficiency; %probability of spiking within duration
%Note this 'probability' is actually the rate in which the spike latency
%was less than the stimulus duration, and thus by definition lower than the
%true probability of spiking a cell with a given stimulus. 

figure(102);clf
subplot(1,3,1)
hold on

plot(dur,pSpike,'color',rgb('red'),'LineWidth',2); %modeled from measured spike times
plot(dur,pSpikeDist,'color','k','LineWidth',2); %smoothed distribution

xlabel('Stim Duration (ms)')
ylabel('Probability of Spiking')
ylim([0 1])

FnumCells=[];

subplot(1,3,2)
hold on
for i=1:numel(deadTime)
    numHolosPerFrame=TotalLaserPower/powerPerTarget*DE50(i);
    FnumCells(i,:)=1000./(dur+deadTime(i)).*pSpikeDist*numHolosPerFrame; %Number of spikeable targets per second as a function of stimulus duration
    
    plot(dur,1000./(dur+deadTime(i)).*pSpikeDist*numHolosPerFrame,'color',colors{i},'LineWidth',2)
    
    [mx ind]=max(1000./(dur+deadTime(i)).*pSpikeDist*numHolosPerFrame); %maximum of this function
    disp(['SLM' num2str(i) '. Max: ' num2str(mx) '. Stimulus Duration:  ' num2str(dur(ind))]);
end
xlabel('Stim Duration (ms)')
ylabel('Max Number of Spikeable Targets in 1 Second')



%% 1.5 Continuous Stimulation.

% As an alternate approach you can stimulate continuously. 

SLMtoOverDrive = 2;
powerVector = [linspace(0,1,round(deadTime(SLMtoOverDrive)*10)) ones([1 max(dur)*10])];

numHolos=[];powerMult=[];
for i =1:numel(dur)
    numHolosPerFrame=TotalLaserPower/powerPerTarget*DE50(SLMtoOverDrive);
    powerMult(i) = mean(powerVector(1:round(dur(i)*10)));
    numHolos(i) = numHolosPerFrame*mean(powerVector(1:round(dur(i)*10)));
end

subplot(1,3,2)
hold on
FnumCells(numel(deadTime)+1,:) = 1000./(dur).*pSpikeDist.*numHolos;

 plot(dur,1000./(dur).*pSpikeDist.*numHolos,'color',rgb('FireBrick'),'LineWidth',2);
 [mx ind]=max(1000./(dur).*pSpikeDist.*numHolos);
 disp(['Overdriven SLM' num2str(SLMtoOverDrive) '. Max: ' num2str(mx) '. Duration:  ' num2str(dur(ind))]);

% subplot(1,3,1)
% hold on
% plot(dur,pSpikeDist.*powerMult,'color',rgb('teal'));


%how fast
subplot(1,3,3)
hold on
for i=1:numel(deadTime)
 plot(dur,1000./(dur+deadTime(i)),'color',colors{i},'LineWidth',2);
end
plot(dur(find(dur>=1000/350,1):end),1000./(dur(find(dur>=1000/350,1):end)),'color',rgb('firebrick'),'LineWidth',2);
xlabel('Stim Duration (ms)')
ylabel('Switch Speed (Hz)')

ylim([0 500])

figure(104);clf
plot(dur,numHolos,'color',rgb('firebrick'),'LineWidth',2)
hold on
for i=1:numel(deadTime)
    plot(dur([1,end]),[TotalLaserPower/powerPerTarget*DE50(i) TotalLaserPower/powerPerTarget*DE50(i)],'color',colors{i},'LineWidth',2)
end

xlabel('Stim Duration (ms)')
ylabel('Maximum Number of Simultaneous Targets')

figure(105);clf
plot(dur,powerMult,'color',rgb('firebrick'),'LineWidth',2)
ylim([0 1])
xlabel('Stim Duration (ms)')
ylabel('Stimulus Efficiency (Norm.)')

%% 1.5 Distance Efficiency Fall Off assume diffraction efficiency of worst

DEmean = [0.999998774346641,0.999981972634438,0.999949594570512,0.999901639861756,0.999838108214849,0.999758999336243,0.999664312932174,0.999554048708652,0.999428206371471,0.999286785626199,0.999129786178185,0.998957207732558,0.998769049994224,0.998565312667868,0.998345995457957,0.998111098068731,0.997860620204213,0.997594561568205,0.997312921864286,0.997015700795816,0.996702898065930,0.996374513377546,0.996030546433358,0.995670996935842,0.995295864587248,0.994905149089610,0.994498850144736,0.994076967454218,0.993639500719422,0.993186449641495,0.992717813921363,0.992233593259730,0.991733787357079,0.991218395913673,0.990687418629553,0.990140855204537,0.989578705338224,0.989000968729991,0.988407645078995,0.987798734084169,0.987174235444227,0.986534148857663,0.985878474022745,0.985207210637523,0.984520358399828,0.983817917007266,0.983099886157221,0.982366265546861,0.981617054873127,0.980852253832742,0.980071862122208,0.979275879437802,0.978464305475584,0.977637139931392,0.976794382500841,0.975936032879326,0.975062090762019,0.974172555843873,0.973267427819618,0.972346706383764,0.971410391230599,0.970458482054190,0.969490978548382,0.968507880406801,0.967509187322846,0.966494898989703,0.965465015100329,0.964419535347465,0.963358459423628,0.962281787021113,0.961189517831997,0.960081651548133,0.958958187861152,0.957819126462466,0.956664467043265,0.955494209294517,0.954308352906970,0.953106897571148,0.951889842977355,0.950657188815674,0.949408934775968,0.948145080547876,0.946865625820817,0.945570570283988,0.944259913626366,0.942933655536705,0.941591795703538,0.940234333815177,0.938861269559714,0.937472602625016,0.936068332698732,0.934648459468289,0.933212982620889,0.931761901843518,0.930295216822938,0.928812927245689,0.927315032798091,0.925801533166241,0.924272428036016,0.922727717093071,0.921167400022841,0.919591476510536,0.917999946241146,0.916392808899444,0.914770064169976,0.913131711737067,0.911477751284824,0.909808182497130,0.908123005057646,0.906422218649815,0.904705822956855,0.902973817661763,0.901226202447316,0.899462976996069,0.897684140990354,0.895889694112284,0.894079636043751,0.892253966466420,0.890412685061742,0.888555791510942,0.886683285495024,0.884795166694770,0.882891434790743,0.880972089463282,0.879037130392507,0.877086557258313,0.875120369740377,0.873138567518151,0.871141150270871,0.869128117677544,0.867099469416962,0.865055205167691,0.862995324608078,0.860919827416249,0.858828713270106,0.856721981847331,0.854599632825384,0.852461665881504,0.850308080692708,0.848138876935791,0.845954054287329,0.843753612423671,0.841537551020952,0.839305869755078,0.837058568301737,0.834795646336397,0.832517103534303,0.830222939570475,0.827913154119717,0.825587746856607,0.823246717455506,0.820890065590548,0.818517790935648,0.816129893164503,0.813726371950581,0.811307226967135,0.808872457887192,0.806422064383560,0.803956046128824,0.801474402795347,0.798977134055273,0.796464239580522,0.793935719042793,0.791391572113563,0.788831798464089,0.786256397765403,0.783665369688319,0.781058713903426,0.778436430081096,0.775798517891475,0.773144977004489,0.770475807089842,0.767791007817018,0.765090578855276,0.762374519873656,0.759642830540975,0.756895510525830,0.754132559496596,0.751353977121423,0.748559763068243,0.745749917004767,0.742924438598479,0.740083327516648,0.737226583426317,0.734354205994309,0.731466194887223,0.728562549771440,0.725643270313116,0.722708356178187,0.719757807032367,0.716791622541150,0.713809802369803,0.710812346183376,0.707799253646699,0.704770524424373,0.701726158180784,0.698666154580093,0.695590513286241,0.692499233962946,0.689392316273704,0.686269759881790,0.683131564450259,0.679977729641938,0.676808255119442,0.673623140545155,0.670422385581245,0.667205989889655,0.663973953132109,0.660726274970107,0.657462955064928,0.654183993077629,0.650889388669046,0.647579141499793,0.644253251230260,0.640911717520619,0.637554540030817,0.634181718420583,0.630793252349418,0.627389141476607,0.623969385461210,0.620533983962068,0.617082936637798,0.613616243146793,0.610133903147231,0.606635916297060,0.603122282254013,0.599593000675596,0.596048071219099,0.592487493541583,0.588911267299892,0.585319392150648,0.581711867750249,0.578088693754873,0.574449869820473,0.570795395602786,0.567125270757321,0.563439494939370,0.559738067804000,0.556020989006057,0.552288258200165,0.548539875040727,0.544775839181922,0.540996150277710,0.537200807981828,0.533389811947789,0.529563161828888,0.525720857278194,0.521862897948557,0.517989283492605,0.514100013562743,0.510195087811154,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;0.999997225027795,0.999986340244876,0.999967346566807,0.999940244907795,0.999905036180678,0.999861721296942,0.999810301166702,0.999750776698713,0.999683148800377,0.999607418377722,0.999523586335417,0.999431653576773,0.999331621003730,0.999223489516876,0.999107260015420,0.998982933397223,0.998850510558771,0.998709992395195,0.998561379800251,0.998404673666340,0.998239874884491,0.998066984344376,0.997886002934297,0.997696931541187,0.997499771050623,0.997294522346809,0.997081186312582,0.996859763829418,0.996630255777427,0.996392663035343,0.996146986480543,0.995893226989036,0.995631385435456,0.995361462693079,0.995083459633806,0.994797377128175,0.994503216045355,0.994200977253143,0.993890661617968,0.993572270004898,0.993245803277621,0.992911262298464,0.992568647928379,0.992217961026951,0.991859202452397,0.991492373061559,0.991117473709912,0.990734505251562,0.990343468539241,0.989944364424308,0.989537193756757,0.989121957385208,0.988698656156908,0.988267290917734,0.987827862512191,0.987380371783408,0.986924819573148,0.986461206721793,0.985989534068358,0.985509802450490,0.985022012704450,0.984526165665133,0.984022262166061,0.983510303039381,0.982990289115859,0.982462221224899,0.981926100194522,0.981381926851375,0.980829702020735,0.980269426526496,0.979701101191182,0.979124726835938,0.978540304280538,0.977947834343373,0.977347317841468,0.976738755590458,0.976122148404613,0.975497497096817,0.974864802478584,0.974224065360046,0.973575286549961,0.972918466855706,0.972253607083283,0.971580708037310,0.970899770521033,0.970210795336320,0.969513783283652,0.968808735162136,0.968095651769506,0.967374533902102,0.966645382354895,0.965908197921475,0.965162981394050,0.964409733563446,0.963648455219112,0.962879147149113,0.962101810140135,0.961316444977481,0.960523052445076,0.959721633325459,0.958912188399792,0.958094718447847,0.957269224248025,0.956435706577330,0.955594166211401,0.954744603924478,0.953887020489428,0.953021416677727,0.952147793259476,0.951266151003387,0.950376490676784,0.949478813045615,0.948573118874440,0.947659408926437,0.946737683963392,0.945807944745709,0.944870192032413,0.943924426581138,0.942970649148130,0.942008860488256,0.941039061354991,0.940061252500422,0.939075434675260,0.938081608628816,0.937079775109025,0.936069934862424,0.935052088634174,0.934026237168042,0.932992381206407,0.931950521490261,0.930900658759209,0.929842793751464,0.928776927203855,0.927703059851817,0.926621192429403,0.925531325669272,0.924433460302688,0.923327597059535,0.922213736668305,0.921091879856094,0.919962027348616,0.918824179870185,0.917678338143731,0.916524502890791,0.915362674831513,0.914192854684648,0.913015043167560,0.911829240996220,0.910635448885211,0.909433667547712,0.908223897695523,0.907006140039040,0.905780395287275,0.904546664147844,0.903304947326966,0.902055245529470,0.900797559458794,0.899531889816972,0.898258237304654,0.896976602621091,0.895686986464144,0.894389389530272,0.893083812514540,0.891770256110626,0.890448721010804,0.889119207905951,0.887781717485559,0.886436250437712,0.885082807449107,0.883721389205034,0.882351996389398,0.880974629684701,0.879589289772043,0.878195977331139,0.876794693040296,0.875385437576424,0.873968211615041,0.872543015830263,0.871109850894806,0.869668717479992,0.868219616255740,0.866762547890570,0.865297513051608,0.863824512404570,0.862343546613783,0.860854616342173,0.859357722251258,0.857852865001162,0.856340045250610,0.854819263656916,0.853290520876008,0.851753817562400,0.850209154369212,0.848656531948159,0.847095950949558,0.845527412022320,0.843950915813951,0.842366462970564,0.840774054136864,0.839173689956149,0.837565371070324,0.835949098119879,0.834324871743908,0.832692692580101,0.831052561264743,0.829404478432711,0.827748444717487,0.826084460751140,0.824412527164335,0.822732644586338,0.821044813645001,0.819349034966780,0.817645309176720,0.815933636898458,0.814214018754231,0.812486455364867,0.810750947349786,0.809007495327005,0.807256099913128,0.805496761723360,0.803729481371492,0.801954259469913,0.800171096629595,0.798379993460119,0.796580950569641,0.794773968564911,0.792959048051283,0.791136189632690,0.789305393911659,0.787466661489312,0.785619992965356,0.783765388938088,0.781902850004403,0.780032376759781,0.778153969798287,0.776267629712587,0.774373357093923,0.772471152532138,0.770561016615659,0.768642949931496,0.766716953065259,0.764783026601138,0.762841171121913,0.760891387208955,0.758933675442220,0.756968036400250,0.754994470660176,0.753012978797716,0.751023561387177,0.749026219001450,0.747020952212012,0.745007761588928,0.742986647700846,0.740957611115009,0.738920652397232,0.736875772111924,0.734822970822074,0.732762249089267,0.730693607473661,0.728617046534002,0.726532566827625,0.724440168910434,0.722339853336943,0.720231620660227,0.718115471431952,0.715991406202369,0.713859425520312,0.711719529933194,0.709571719987018,0.707415996226357,0.705252359194382,0.703080809432834,0.700901347482042,0.698713973880913,0.696518689166939,0.694315493876189,0.692104388543317,0.689885373701556,0.687658449882720,0.685423617617202,0.683180877433979,0.680930229860603,0.678671675423208,0.676405214646508,0.674130848053797,0.671848576166949,0.669558399506411,0.667260318591214,0.664954333938968,0.662640446065859,0.660318655486651,0.657988962714686,0.655651368261886,0.653305872638752,0.650952476354353,0.648591179916343,0.646221983830954,0.643844888602989,0.641459894735829,0.639067002731438,0.636666213090346,0.634257526311664,0.631840942893075,0.629416463330848,0.626984088119812,0.624543817753381,0.622095652723543,0.619639593520853,0.617175640634458,0.614703794552054,0.612224055759931,0.609736424742950,0.607240901984532,0.604737487966690,0.602226183169994,0.599706988073597,0.597179903155224,0.594644928891167,0.592102065756291,0.589551314224043,0.586992674766429,0.584426147854036,0.581851733956013,0.579269433540090,0.576679247072564,0.574081175018302,0.571475217840740,0.568861376001894,0.566239649962333,0.563610040181216,0.560972547116252,0.558327171223740,0.555673912958529,0.553012772774054,0.550343751122305,0.547666848453848,0.544982065217816,0.542289401861915,0.539588858832412,0.536880436574143,0.534164135530518,0.531439956143507,0.528707898853653,0.525967964100062,0.523220152320408,0.520464463950935,0.517700899426445,0.514929459180323,0.512150143644498,0.509362953249482,0.506567888424347,0.503764949596724,0.500954137192826,0.498135451637412,0.495308893353817,0.492474462763941,0.489632160288242,0.486781986345746,0.483923941354048,0.481058025729295,0.478184239886205,0.475302584238065,0.472413059196712,0.469515665172555,0.466610402574568,0.463697271810277,0.460776273285782,0.457847407405736,0.454910674573358,0.451966075190432,0.449013609657297,0.446053278372860,0.443085081734584,0.440109020138491,0.437125093979175,0.434133303649777,0.431133649542006,0.428126132046130,0.425110751550977,0.422087508443934,0.419056403110943,0.416017435936518,0.412970607303717,0.409915917594167,0.406853367188052,0.403782956464110,0.400704685799642,0.397618555570505,0.394524566151116,0.391422717914445,0.388313011232024,0.385195446473940,0.382070024008838,0.378936744203922,0.375795607424949,0.372646614036229,0.369489764400638,0.366325058879603,0.363152497833106,0.359972081619682,0.356783810596429,0.353587685118994,0.350383705541584,0.347171872216950,0.343952185496413,0.340724645729838,0.337489253265650,0.334246008450818,0.330994911630879,0.327735963149911,0.324469163350553,0.321194512573996,0.317912011159979,0.314621659446798,0.311323457771309,0.308017406468901,0.304703505873532,0.301381756317704,0.298052158132483,0.294714711647463,0.291369417190808,0.288016275089233,0.284655285667993,0.281286449250903,0.277909766160321,0.274525236717165,0.271132861240894,0.267732640049520,0.264324573459611,0.260908661786276,0.257484905343170,0.254053304442511,0.250613859395054,0.247166570510106,0.243711438095528,0.240248462457718,0.236777643901632,0.233298982730768,0.229812479247179,0.226318133751455,0.222815946542742,0.219305917918727,0.215788048175648,0.212262337608285,0.208728786509972,0.205187395172583,0.201638163886541,0.198081092940813,0.194516182622909,0.190943433218893,0.187362845013367,0.183774418289476,0.180178153328915,0.176574050411928,0.172962109817293,0.169342331822335,0.165714716702928,0.162079264733487,0.158435976186967,0.154784851334873,0.151125890447248,0.147459093792682,0.143784461638300,0.140101994249782,0.136411691891337,0.132713554825730,0.129007583314254,0.125293777616751,0.121572137991607,0.117842664695746,0.114105357984628,0.110360218112265,0.106607245331204,0.102846439892528,0.0990778020458719,0.0953013320393924,0.0915170301198117,0.0877248965323671,0.0839249315208515,0.0801171353275885,0.0763015081934444,0.0724780503578229,0.0686467620586696,0.0648076435324636,0.0609606950142296,0.0571059167375202,0.0532433089344324,0.0493728718356054,0.0454946056702096,0.0416085106659453,0.0377145870490665,0.0338128350443553,0.0299032548751279,0.0259858467632403,0.0220606109290895,0.0181275475915932,0.0141866569682270,0.0102379392749865,0.00628139472640707,0.00231702353555782,-0.00165517408595620,-0.00563519792799203,-0.00962304778187251,-0.0136187234403954,-0.0176222246978091,-0.0216335513498417,-0.0256527031936754,-0.0296796800279661,-0.0337144816528393,-0.0377571078698775,-0.0418075584821414,-0.0458658332941460,-0.0499319321118813,-0.0540058547428095,-0.0580876009958534,-0.0621771706813988,-0.0662745636113122,-0.0703797795989240,-0.0744928184590269,-0.0786136800078910,-0.0827423640632485,-0.0868788704443059,-0.0910231989717343,-0.0951753494676813,-0.0993353217557539,-0.103503115661038,-0.107678731010091,-0.111862167630930,-0.116053425353050,-0.120252504007419,-0.124459403426469,-0.128674123444111,-0.132896663895722,-0.137127024618147,-0.141365205449714,-0.145611206230216,-0.149865026800916,-0.154126667004554,-0.158396126685338,-0.162673405688956,-0.166958503862559,-0.171251421054782,-0.175552157115723,-0.179860711896964,-0.184177085251547,-0.188501277034009,-0.192833287100338,-0.197173115308012,-0.201520761515978,-0.205876225584654,-0.210239507375942,-0.214610606753217,-0.218989523581317,-0.223376257726569,-0.227770809056779,-0.232173177441218,-0.236583362750638,-0.241001364857261,-0.245427183634798,-0.249860818958427,-0.254302270704814,-0.258751538752079,-0.263208622979848,-0.267673523269205,-0.272146239502718,-0.276626771564437,-0.281115119339884,-0.285611282716056,-0.290115261581445,-0.294627055826003,-0.299146665341171,-0.303674090019868,-0.308209329756495,-0.312752384446923,-0.317303253988510,-0.321861938280091,-0.326428437221991,-0.331002750715999,-0.335584878665399,-0.340174820974945,-0.344772577550880,-0.349378148300922,-0.353991533134278,-0.358612731961627,-0.363241744695138,-0.367878571248457,-0.372523211536716,-0.377175665476526,-0.381835932985977,-0.386504013984657,-0.391179908393621,-0.395863616135406,-0.400555137134047,-0.405254471315061,-0.409961618605427,-0.414676578933636,-0.419399352229642,-0.424129938424898,-0.428868337452332,-0.433614549246362,-0.438368573742893,-0.443130410879300,-0.447900060594471,-0.452677522828749,-0.457462797523986,-0.462255884623509,-0.467056784072128,-0.471865495816155,-0.476682019803369,-0.481506355983046,-0.486338504305955,-0.491178464724339,-0.496026237191934,-0.500881821663968,-0.505745218097149,-0.510616426449681,-0.515495446681246,-0.520382278753024,-0.525276922627679,-0.530179378269367,-0.535089645643727,-0.540007724717890,-0.544933615460482,-0.549867317841605,-0.554808831832869,-0.559758157407355,-0.564715294539651,-0.569680243205821,-0.574653003383435,-0.579633575051537,-0.584621958190668,-0.589618152782871,-0.594622158811663,-0.599633976262066,-0.604653605120587,-0.609681045375223,-0.614716297015474,-0.619759360032318,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN;0.999997757468462,0.999983068857751,0.999955934570836,0.999916355010690,0.999864330580284,0.999799861682593,0.999722948720585,0.999633592097234,0.999531792215512,0.999417549478391,0.999290864288843,0.999151737049840,0.999000168164355,0.998836158035359,0.998659707065823,0.998470815658720,0.998269484217023,0.998055713143703,0.997829502841732,0.997590853714082,0.997339766163725,0.997076240593633,0.996800277406779,0.996511877006135,0.996211039794671,0.995897766175360,0.995572056551176,0.995233911325089,0.994883330900071,0.994520315679093,0.994144866065130,0.993756982461153,0.993356665270133,0.992943914895042,0.992518731738853,0.992081116204537,0.991631068695068,0.991168589613415,0.990693679362552,0.990206338345452,0.989706566965085,0.989194365624422,0.988669734726437,0.988132674674105,0.987583185870393,0.987021268718274,0.986446923620722,0.985860150980707,0.985260951201201,0.984649324685179,0.984025271835610,0.983388793055466,0.982739888747722,0.982078559315347,0.981404805161314,0.980718626688595,0.980020024300161,0.979308998398987,0.978585549388042,0.977849677670300,0.977101383648732,0.976340667726310,0.975567530306006,0.974781971790792,0.973983992583641,0.973173593087525,0.972350773705414,0.971515534840281,0.970667876895099,0.969807800272838,0.968935305376473,0.968050392608974,0.967153062373315,0.966243315072464,0.965321151109398,0.964386570887084,0.963439574808498,0.962480163276613,0.961508336694394,0.960524095464819,0.959527439990859,0.958518370675487,0.957496887921672,0.956462992132388,0.955416683710607,0.954357963059301,0.953286830581443,0.952203286680002,0.951107331757953,0.949998966218266,0.948878190463913,0.947745004897868,0.946599409923103,0.945441405942588,0.944270993359296,0.943088172576199,0.941892943996269,0.940685308022478,0.939465265057799,0.938232815505202,0.936987959767659,0.935730698248145,0.934461031349630,0.933178959475087,0.931884483027485,0.930577602409799,0.929258318025002,0.927926630276063,0.926582539565956,0.925226046297652,0.923857150874123,0.922475853698340,0.921082155173278,0.919676055701908,0.918257555687200,0.916826655532130,0.915383355639665,0.913927656412781,0.912459558254448,0.910979061567638,0.909486166755325,0.907980874220477,0.906463184366071,0.904933097595077,0.903390614310465,0.901835734915210,0.900268459812283,0.898688789404656,0.897096724095299,0.895492264287186,0.893875410383291,0.892246162786582,0.890604521900034,0.888950488126616,0.887284061869305,0.885605243531068,0.883914033514879,0.882210432223711,0.880494440060534,0.878766057428321,0.877025284730046,0.875272122368677,0.873506570747189,0.871728630268552,0.869938301335741,0.868135584351725,0.866320479719478,0.864492987841971,0.862653109122176,0.860800843963066,0.858936192767612,0.857059155938785,0.855169733879560,0.853267926992908,0.851353735681798,0.849427160349206,0.847488201398103,0.845536859231460,0.843573134252250,0.841597026863442,0.839608537468014,0.837607666468934,0.835594414269173,0.833568781271704,0.831530767879501,0.829480374495536,0.827417601522778,0.825342449364201,0.823254918422777,0.821155009101478,0.819042721803275,0.816918056931142,0.814781014888050,0.812631596076970,0.810469800900874,0.808295629762737,0.806109083065527,0.803910161212220,0.801698864605785,0.799475193649196,0.797239148745422,0.794990730297438,0.792729938708216,0.790456774380726,0.788171237717941,0.785873329122834,0.783563048998375,0.781240397747539,0.778905375773296,0.776557983478617,0.774198221266477,0.771826089539846,0.769441588701694,0.767044719154998,0.764635481302726,0.762213875547851,0.759779902293346,0.757333561942183,0.754874854897334,0.752403781561769,0.749920342338462,0.747424537630385,0.744916367840510,0.742395833371807,0.739862934627251,0.737317672009812,0.734760045922464,0.732190056768177,0.729607704949921,0.727012990870674,0.724405914933404,0.721786477541084,0.719154679096686,0.716510520003181,0.713854000663543,0.711185121480741,0.708503882857750,0.705810285197541,0.703104328903087,0.700386014377357,0.697655342023326,0.694912312243965,0.692156925442247,0.689389182021142,0.686609082383622,0.683816626932661,0.681011816071232,0.678194650202304,0.675365129728850,0.672523255053842,0.669669026580251,0.666802444711053,0.663923509849216,0.661032222397713,0.658128582759517,0.655212591337598,0.652284248534931,0.649343554754486,0.646390510399235,0.643425115872152,0.640447371576206,0.637457277914371,0.634454835289617,0.631440044104920,0.628412904763248,0.625373417667576,0.622321583220872,0.619257401826114,0.616180873886268,0.613091999804310,0.609990779983211,0.606877214825943,0.603751304735476,0.600613050114786,0.597462451366841,0.594299508894616,0.591124223101082,0.587936594389210,0.584736623161974,0.581524309822343,0.578299654773292,0.575062658417792,0.571813321158816,0.568551643399334,0.565277625542320,0.561991267990744,0.558692571147580,0.555381535415798,0.552058161198372,0.548722448898273,0.545374398918474,0.542014011661945,0.538641287531660,0.535256226930590,0.531858830261708,0.528449097927985,0.525027030332393,0.521592627877905,0.518145890967490,0.514686820004126,0.511215415390779,0.507731677530424,0.504235606826033,0.500727203680577,0.497206468497028,0.493673401678360,0.490128003627544,0.486570274747551,0.483000215441352,0.479417826111922,0.475823107162232,0.472216058995253,0.468596682013958,0.464964976621320,0.461320943220307,0.457664582213896,0.453995894005056,0.450314878996762,0.446621537591981,0.442915870193688,0.439197877204855,0.435467559028457,0.431724916067462,0.427969948724839,0.424202657403568,0.420423042506617,0.416631104436955,0.412826843597560,0.409010260391400,0.405181355221449,0.401340128490677,0.397486580602058,0.393620711958563,0.389742522963165,0.385852014018833,0.381949185528543,0.378034037895265,0.374106571521971,0.370166786811635,0.366214684167226,0.362250263991717,0.358273526688081,0.354284472659290,0.350283102308315,0.346269416038127,0.342243414251703,0.338205097352009,0.334154465742021,0.330091519824709,0.326016260003045,0.321928686680001,0.317828800258551,0.313716601141665,0.309592089732316,0.305455266433476,0.301306131648118,0.297144685779211,0.292970929229730,0.288784862402645,0.284586485700930,0.280375799527554,0.276152804285490,0.271917500377714,0.267669888207195,0.263409968176903,0.259137740689813,0.254853206148894,0.250556364957123,0.246247217517467,0.241925764232903,0.237592005506397,0.233245941740925,0.228887573339458,0.224516900704969,0.220133924240429,0.215738644348811,0.211331061433085,0.206911175896224,0.202478988141201,0.198034498570988,0.193577707588556,0.189108615596876,0.184627222998924,0.180133530197668,0.175627537596083,0.171109245597137,0.166578654603807,0.162035765019058,0.157480577245871,0.152913091687212,0.148333308746055,0.143741228825372,0.139136852328135,0.134520179657313,0.129891211215884,0.125249947406813,0.120596388633081,0.115930535297651,0.111252387803499,0.106561946553598,0.101859211950917,0.0971441843984328,0.0924168642991115,0.0876772520559303,0.0829253480718569,0.0781611527498682,0.0733846664929319,0.0685958897040219,0.0637948227861106,0.0589814661421690,0.0541558201751691,0.0493178852880820,0.0444676618838841,0.0396051503655411,0.0347303511360312,0.0298432645983201,0.0249438911553862,0.0200322312101986,0.0151082851657281,0.0101720534249469,0.00522353639083008,0.000262734466347753,-0.00471035194552961,-0.00969572244182933,-0.0146933766195763,-0.0197033140758020,-0.0247255344075328,-0.0297600372117967,-0.0348068220856246,-0.0398658886260395,-0.0449372364300716,-0.0500208650947484,-0.0551167742171021,-0.0602249633941543,-0.0653454322229381,-0.0704781803004765,-0.0756232072238024,-0.0807805125899424,-0.0859500959959206,-0.0911319570387677,-0.0963260953155138,-0.101532510423186,-0.106751201958809,-0.111982169519413,-0.117225412702030,-0.122480931103681,-0.127748724321396,-0.133028791952207,-0.138321133593137,-0.143625748841217,-0.148942637293472,-0.154271798546935,-0.159613232198630,-0.164966937845584,-0.170332915084828,-0.175711163513389,-0.181101682728295,-0.186504472326574,-0.191919531905252,-0.197346861061360,-0.202786459391925,-0.208238326493973,-0.213702461964536,-0.219178865400638,-0.224667536399310,-0.230168474557578,-0.235681679472471,-0.241207150741015,-0.246744887960240,-0.252294890727175,-0.257857158638844,-0.263431691292279,-0.269018488284506,-0.274617549212554,-0.280228873673449,-0.285852461264223,-0.291488311581899,-0.297136424223508,-0.302796798786078,-0.308469434866635,-0.314154332062208,-0.319851489969826,-0.325560908186516,-0.331282586309307,-0.337016523935223,-0.342762720661299,-0.348521176084558,-0.354291889802030,-0.360074861410739,-0.365870090507718,-0.371677576689993,-0.377497319554592,-0.383329318698542,-0.389173573718871,-0.395030084212611,-0.400898849776784,-0.406779870008421,-0.412673144504553,-0.418578672862203,-0.424496454678400,-0.430426489550174,-0.436368777074551,-0.442323316848559,-0.448290108469228,-0.454269151533583,-0.460260445638654,-0.466263990381469,-0.472279785359058,-0.478307830168445,-0.484348124406657,-0.490400667670727,-0.496465459557679,-0.502542499664544,-0.508631787588348,-0.514733322926119,-0.520847105274886,-0.526973134231675,-0.533111409393516,-0.539261930357438,-0.545424696720466,-0.551599708079629,-0.557786964031954,-0.563986464174473,-0.570198208104210,-0.576422195418195,-0.582658425713453,-0.588906898587014,-0.595167613635909,-0.601440570457163,-0.607725768647799,-0.614023207804856,-0.620332887525353,-0.626654807406321,-0.632988967044790,-0.639335366037784,-0.645694003982333,-0.652064880475466,-0.658447995114208,-0.664843347495590,-0.671250937216638,-0.677670763874382,-0.684102827065849,-0.690547126388066,-0.697003661438061,-0.703472431812864,-0.709953437109500,-0.716446676925000,-0.722952150856390,-0.729469858500699,-0.735999799454955,-0.742541973316185,-0.749096379681418,-0.755663018147680,-0.762241888312003,-0.768832989771410,-0.775436322122934,-0.782051884963598,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN];
DEmean(DEmean<0)=0;
DEmean(DEmean>1)=1;
figure(106);clf

for i=2:numel(deadTime) 
    x = FnumCells(i,:)'*DEmean(i-1,:);
    subplot(1,numel(deadTime) -1,i-1)
    imagesc(x')
    ylim([0 500])
    caxis([0 5000])
    ylabel('Distance from Zero Order (\mum)')
    xlabel('Duration of Stimulation (ms)')
    colorbar
    axis square
end
%%
figure(108); clf
distList = [50 100 150 200 250];% 300 350 400 450 500];

for i = 2:numel(deadTime)
    s=i-1;
    subplot(1,3,s)
    hold on
    for k= 1:numel(distList)
        plot(dur,FnumCells(i,:)*DEmean(s,distList(k)),'color',colors{i},'LineWidth',2)
    end
    ylim([0 5500])
    ylabel('Max Number of Spikeable Targets in 1 Second')
    xlabel('Stim Duration (ms)')
end

%% 1.6 Distance Efficency fall off assume mean diffraction efficiency
VolDE = [0.999997548694210,0.999980710653337,0.999953541842624,0.999915881666404,0.999867172623781,0.999810084961549,0.999741937619372,0.999661879220433,0.999571524151069,0.999473496937154,0.999363549105955,0.999244132543119,0.999106971089459,0.998972300951082,0.998824483399556,0.998657714094595,0.998487225999728,0.998299363560324,0.998099542988231,0.997907938970945,0.997675122692053,0.997439390765721,0.997222251379708,0.996984533601667,0.996727937671826,0.996456880830335,0.996164069526866,0.995881125692547,0.995599200845598,0.995273870994197,0.994986190173423,0.994651054887374,0.994283127236234,0.993966608413034,0.993602924334517,0.993235688202265,0.992803927708610,0.992461732208898,0.992023843829376,0.991597127472798,0.991204401997663,0.990805321433620,0.990320069428860,0.989883250135510,0.989410159955671,0.988939574832130,0.988420925169197,0.987990554661570,0.987447032188540,0.986968536543769,0.986394516110059,0.985803112528091,0.985274762159883,0.984736186722661,0.984064611854603,0.983641537435837,0.983001361059400,0.982397581966651,0.981745402148653,0.981194114677488,0.980577890880405,0.980025577893158,0.979212174689251,0.978571697306332,0.977872441585341,0.977287514153105,0.976598557276499,0.975787198238868,0.975121894252206,0.974389089949557,0.973576741542218,0.972699955890703,0.972065495212796,0.971322002163558,0.970509738898282,0.969683746433791,0.969120396196090,0.968187634261792,0.967287129598773,0.966494226923867,0.965658440039553,0.964655036751183,0.963872325533598,0.963018939639564,0.961998291830011,0.961388719041190,0.960298122446532,0.959672432884307,0.958507923452905,0.957641586827390,0.956598865708360,0.955719666330822,0.954580912616851,0.953540938274848,0.952630341648950,0.951760396138661,0.950516855052552,0.949348152821162,0.948317810524459,0.947558814350718,0.946515225105650,0.945269045255351,0.944353692198923,0.943222529620896,0.942037241119882,0.941115361158784,0.939451951569241,0.938726428494405,0.937280904194440,0.936437798034500,0.934870661658176,0.933791574601684,0.933032960462062,0.931496632743967,0.930269539910305,0.929457896959857,0.928366593829526,0.926702594165430,0.925349915719786,0.924139992385011,0.922908412714676,0.921505929101582,0.920650375031851,0.918828183198474,0.917419638893539,0.916406542798272,0.914834671518722,0.913601038185582,0.911947045959571,0.910536128519447,0.909264575618862,0.908348717169243,0.906412217751847,0.905246896433864,0.904057280994255,0.902194779863738,0.900753459039618,0.899331780373904,0.897673563662248,0.896157496458070,0.894571381643397,0.893499762474502,0.892517386711673,0.890096128409846,0.888427454882402,0.887214784848533,0.885496011705984,0.883507436555030,0.882174316987215,0.880405695748343,0.878674675811944,0.877434461115778,0.875470460914084,0.873390868339767,0.872114329283287,0.870231282514845,0.868911472395199,0.867442222322354,0.864405247841320,0.863639486622811,0.862294402309570,0.860475025325975,0.857948099499487,0.856349930274781,0.854869551142471,0.853639470366623,0.850847449690269,0.849631601891624,0.847588516745704,0.845574877417323,0.843230637351327,0.841103200029492,0.840274436495828,0.837759968273752,0.835205330996400,0.833921271690989,0.831967397638266,0.830757138170042,0.827453014327184,0.826724728632321,0.824299113689393,0.822755200756146,0.820475552973579,0.818297610434597,0.817057204291202,0.813038236819015,0.811197129193809,0.809860456784138,0.807874991550473,0.805327269064842,0.802856331568484,0.801529106606336,0.799336691580387,0.796793840262580,0.794851281029856,0.792756099976484,0.790820132077535,0.788127276864660,0.785404739448986,0.784086201985322,0.781440114814979,0.778814412727727,0.777166949508346,0.774695233714385,0.772269886082680,0.769046104725213,0.766754016878230,0.764774523963291,0.763651432280034,0.759588218738406,0.756244541493405,0.756697929503127,0.753261370722448,0.750339104101277,0.748794987348458,0.744879282039243,0.741978874434905,0.741188548349708,0.737595706042758,0.734389597085398,0.732731741512081,0.729377933421309,0.727473791833532,0.724408010680634,0.722211118307313,0.719757904975180,0.716956656815585,0.713346756836263,0.711864111616918,0.709032636373603,0.706824240148945,0.703407129874771,0.700305790597502,0.697975571427171,0.695056189485070,0.691063103218386,0.690133425986695,0.687441199409405,0.684423328113115,0.679050060260350,0.676318417180906,0.674414639148556,0.674025567810803,0.670148112298674,0.665520918675418,0.663257781234612,0.659133101537029,0.657084907544845,0.652771180141543,0.651573522794396,0.647768492938754,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0.999994450056334,0.999983540310394,0.999967257829607,0.999945485056902,0.999917938557641,0.999886161629963,0.999848606389574,0.999804956674660,0.999755542427408,0.999702900508393,0.999643047183508,0.999579318224227,0.999504347876789,0.999433616343984,0.999354217321420,0.999265401048186,0.999173887301561,0.999074472541833,0.998969045897446,0.998866604481294,0.998744030071005,0.998618667198629,0.998503463305252,0.998379684404172,0.998242005110196,0.998099174989775,0.997944358826690,0.997796154478977,0.997646732391351,0.997475637442884,0.997323399900551,0.997149121037591,0.996955126088300,0.996787793962080,0.996598771026533,0.996408381080352,0.996175476685876,0.995998905296303,0.995767084855036,0.995543257675901,0.995336552413383,0.995126057763743,0.994876672957814,0.994647035736672,0.994396488951776,0.994149747201143,0.993881212281821,0.993658868070929,0.993368884616233,0.993124162597488,0.992826322409451,0.992511298104211,0.992238328587558,0.991950984983238,0.991604299884561,0.991389406726262,0.991044106071921,0.990739551553157,0.990392966427322,0.990102869403751,0.989782844829277,0.989498988869279,0.989071837250294,0.988741934932993,0.988377871236914,0.988071330928831,0.987697022914939,0.987294758796035,0.986960172243597,0.986565224170155,0.986130037765114,0.985668899667375,0.985360042784298,0.984963497004935,0.984539489404502,0.984111308912778,0.983821648369570,0.983325510640897,0.982867704123462,0.982462098220404,0.982012446432790,0.981485123310665,0.981096208968943,0.980636930281510,0.980109279758923,0.979803985134119,0.979241982778158,0.978908340395624,0.978298738577776,0.977846009989149,0.977321395275544,0.976844180878149,0.976274696478185,0.975727216877596,0.975278348514411,0.974826675282186,0.974160313610736,0.973564776272726,0.973031251768795,0.972653205090128,0.972097775064054,0.971449172454332,0.970969990697019,0.970388810152720,0.969778644926080,0.969291962389677,0.968451326311290,0.968092821066181,0.967310287997961,0.966907173473769,0.966075091798257,0.965526800957889,0.965133331676081,0.964370667770984,0.963724475486896,0.963315882344402,0.962714464308587,0.961873370302823,0.961182040061128,0.960513930697227,0.959921263884589,0.959214241610383,0.958757593102914,0.957839203849904,0.957090284685449,0.956580140693593,0.955730991514372,0.955127413206172,0.954301691838147,0.953549213013664,0.952885103839416,0.952423806701971,0.951413268119391,0.950853201378173,0.950239222068117,0.949270551324240,0.948512991246592,0.947817769737861,0.946936732873857,0.946123922612218,0.945326518552210,0.944830911656565,0.944336016862091,0.943100948237585,0.942247706813674,0.941548824334642,0.940672444154754,0.939741580802097,0.939002581065782,0.938130330447672,0.937216533420643,0.936589226421494,0.935558603987668,0.934495444156836,0.933871756921838,0.932980710700503,0.932263209245505,0.931536637931742,0.929921701710299,0.929616041148774,0.928912128620719,0.927950889119140,0.926733142484944,0.925811487781951,0.925129898547133,0.924512937020914,0.923024013384763,0.922495480509744,0.921419477189204,0.920445379800459,0.919247061161525,0.918179479904230,0.917762846774307,0.916484235339848,0.915120260910688,0.914542021119308,0.913463456968709,0.912861061197765,0.911222631598362,0.910928057650395,0.909665959881838,0.908954206839088,0.907743831544913,0.906669264210838,0.906088612127593,0.903920677812128,0.903021256909505,0.902321019342150,0.901378753007925,0.900057563623280,0.898820920046054,0.898257714706402,0.897090620467750,0.895754310388119,0.894816852877537,0.893812350113862,0.892873922043863,0.891477292837965,0.890115877165487,0.889515561211041,0.888110367978377,0.886762106529584,0.885986066862714,0.884808790305443,0.883600756858983,0.881814357194462,0.880665813372951,0.879885031524994,0.879339472806003,0.877196673053060,0.875616947799957,0.875882348898251,0.874112859795253,0.872653510923993,0.872115021074927,0.870075308450501,0.868496246059779,0.868344339158105,0.866387686749898,0.864768146160406,0.864004733682987,0.862275213475957,0.861447327999357,0.859838494261690,0.858693856265439,0.857624974414169,0.856179926706438,0.854445592786602,0.853723138027888,0.852491752065258,0.851371340261688,0.849699278800746,0.848115821705430,0.846929906554898,0.845649318442000,0.843512939728467,0.843275632683449,0.842015092058456,0.840476516097269,0.837617000373147,0.836437301253886,0.835737660199611,0.835755420589756,0.833688328639384,0.831360845941598,0.830150018498752,0.828302785814508,0.827291908217631,0.825191241918983,0.824623804523658,0.822962211061037,0.820423011383380,0.820597882688480,0.818890047894618,0.817256286976726,0.815535382182219,0.814375158938034,0.811986563660388,0.811028185889201,0.809753858605493,0.807840169723725,0.807190149471829,0.804420391956401,0.802960172206625,0.801408239992538,0.799924127026553,0.798220022834020,0.796862754717291,0.795615406054680,0.793455597181090,0.791805337992770,0.789582435498210,0.789173251805165,0.787454770856390,0.785843389002030,0.782964654006284,0.781902861218208,0.780413057399677,0.778121056556905,0.776395240521151,0.776669532610269,0.773876512945621,0.771718028511691,0.771744609176292,0.768959652967254,0.766493910511429,0.766054887830307,0.763309240585565,0.761123103798764,0.758601857566334,0.757862444313953,0.756428161954087,0.753428878278209,0.752518017277121,0.751792436655999,0.748441139258657,0.746394158772814,0.744534552533195,0.742958750375479,0.740461004953776,0.739411387281586,0.737846677469148,0.736179299578986,0.733413076838906,0.731619362297292,0.729448338304599,0.726849927346492,0.727212959143125,0.724630412166439,0.722022693745264,0.720594414139504,0.717745649850114,0.715668435992632,0.715132436170703,0.712321003959194,0.709401260710862,0.708328714649087,0.705874688948045,0.704245417094689,0.702091494292013,0.701290292888416,0.697384387868585,0.695731895991359,0.695018252193228,0.690743744341264,0.689611053868295,0.687423661798228,0.685045380846710,0.683730950465013,0.681072047734135,0.679861143279386,0.676965368979214,0.673554262163398,0.671860541534157,0.669824394029473,0.667672365822671,0.665961248757939,0.662648268006794,0.661880886984933,0.659394182913994,0.654779812578078,0.653272579972374,0.651064197089502,0.647887134096530,0.645707198209640,0.646177936923948,0.641265473846781,0.639085535512275,0.635427796996987,0.633249442174995,0.632687706841206,0.628913456266406,0.625946933385701,0.625736615246025,0.622824403933152,0.620966527464083,0.618412102063090,0.613721733687297,0.613408332216595,0.609853178271336,0.606571664808594,0.605821936841821,0.600872530300571,0.598323234835042,0.596272765055648,0.595868647209725,0.593582082626220,0.589204337156028,0.586396277211770,0.584186896479129,0.580189558855197,0.578151605697021,0.573718883045789,0.573552338853091,0.571360315245213,0.566707431304789,0.562395750891796,0.560465011237658,0.556345221636038,0.554247515573578,0.551955400283263,0.548082646959271,0.544329032615647,0.542809429780336,0.539664574127597,0.533324227887190,0.532005633477294,0.530005371075655,0.526597296367097,0.522032865457888,0.520361665529126,0.516192607593327,0.510240423029647,0.510484952466437,0.507819009539471,0.500884810187568,0.498808240939094,0.494505638853594,0.491509311005016,0.489444410676361,0.483743050594624,0.481447115471909,0.477794567056356,0.475464955867205,0.472338124513617,0.464843868567908,0.462643327337347,0.458256473941165,0.452175262328473,0.449640121395380,0.444906407940418,0.440220399849146,0.438583189873098,0.429862836148996,0.428364674048007,0.419512328160217,0.418938255900824,0.411666081193610,0.407614484049254,0.403177271211331,0.398232599861305,0.390651590093975,0.383994029697424,0.379287755276598,0.375648037699011,0.370509124481258,0.359288417058743,0.353759329249430,0.346089147872973,0.340777197408394,0.330546473306814,0.321655548173195,0.310653929557273,0.299917130651656,0.290547588461826,0.284153081228062,0.263006889415364,0.238737170380327,0.184941077644831,0.0710804822126055,-0.246148727510372,-0.493661469833956,0.447646048006677,0.252004713420413,-0.0365778622840860,0.492474189976437,0.615423693057690,0.114216143090790,0.158246422489865,0.192398491706730,-0.216228308673536,0.251621103973049,0.455813548473162,0.296727165399186,0.219414954827044,0.0460270152856337,-0.613196278172419,0.401126790622156,0.339447827455824,0.435946372575933,0.525326810673366,0.162554860066629,0.178510570039436,-0.433077261447278,-0.114730936718270,0.909068648239907,0.932181083805098,-2.09276486035865,0.543065574134280,0.0566917265233347,0.200435808322226,0.814917552159785,0.0464227657189509,-0.0162995600357927,0.421725108581051,0.195048727484945,0.389493779130506,5.35123497521353,3.85348708784627,0.311068218064974,0.832418596717241,0.284384977392702,0.522558700841258,0.247352906785059,0.190512384944461,-0.297884082585755,0.0653579812049830,0.265055242468131,0.412658374086034,0.333447568386168,-3.06846989690995,-1.08820256471388,0.997942675875146,0.334049359480931,-7.37817255541352,2.75473325948839,1.88717187705423,0.385295183642209,0.0547582711830019,0.378617082224788,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0.999995514937064,0.999980797133132,0.999957837266692,0.999926516089179,0.999886351186892,0.999839475697955,0.999783741892920,0.999718146195404,0.999645043377205,0.999564631250405,0.999476499947069,0.999378919627029,0.999270492781059,0.999159164923787,0.999040677729869,0.998905863395256,0.998769904597174,0.998617544100542,0.998455069839453,0.998302523274548,0.998113416463313,0.997924856978322,0.997751049844936,0.997556371395767,0.997354426154608,0.997136147290836,0.996901570216645,0.996672439271416,0.996448026593806,0.996186468999834,0.995957395561109,0.995684605482468,0.995390283289678,0.995138463561792,0.994842938919951,0.994543513032037,0.994209574281579,0.993929505687278,0.993582682292213,0.993240589194263,0.992928338850849,0.992611103854035,0.992212890230015,0.991865215798455,0.991492462414472,0.991115718920256,0.990694919631228,0.990345756626977,0.989921626555429,0.989528041222092,0.989063931557496,0.988602382079049,0.988173599232564,0.987755751989211,0.987209908120258,0.986860373731106,0.986370921586577,0.985866538464593,0.985358007908426,0.984923629222662,0.984428361371683,0.983980887404338,0.983334829373735,0.982816084937721,0.982256230423445,0.981794360157238,0.981275628395338,0.980584816410336,0.980032063714007,0.979473473828161,0.978848494673829,0.978159205550683,0.977611176527133,0.977037470663140,0.976391450057714,0.975730796893454,0.975277256435397,0.974558652209813,0.973817379284462,0.973172627438213,0.972534452710851,0.971750353078528,0.971089459745602,0.970442077779134,0.969624847245384,0.969124616381206,0.968242440427097,0.967771754447144,0.966847061258407,0.966167175189968,0.965303197618422,0.964651403262440,0.963699803714436,0.962889277546004,0.962114809676573,0.961430462218817,0.960487640980867,0.959533102918239,0.958715577763896,0.958084098634118,0.957283994222926,0.956300606920081,0.955589948694960,0.954686260667899,0.953728522553269,0.953031402105086,0.951658775970877,0.951056600729683,0.949978397735036,0.949250432223926,0.948043294272528,0.947173004534752,0.946586039673206,0.945299734874279,0.944348323520121,0.943694708152891,0.942924612273858,0.941554570616496,0.940469193822357,0.939608516056389,0.938537553998689,0.937384120241220,0.936754445733315,0.935262425840594,0.934217500033706,0.933398112589163,0.932207117009174,0.931173386552374,0.929809648444759,0.928748788823096,0.927770020306398,0.927062716044353,0.925547359302809,0.924555893639352,0.923637475767544,0.922147790087676,0.921070905590185,0.919886020876181,0.918630052401454,0.917498393000898,0.916231077078065,0.915284688859762,0.914489761680795,0.912533407979132,0.911207395843024,0.910464395972232,0.909101929340949,0.907317881931185,0.906404953396417,0.904979338032081,0.903635407173033,0.902665544705107,0.901157225185056,0.899505185211219,0.898479396619591,0.896826250715963,0.895903707390144,0.894752261699007,0.892394968375984,0.891734369927148,0.890659645539213,0.889337111011883,0.887154156669087,0.886196566101794,0.884845738773548,0.883935518790001,0.881772922563228,0.880746121855235,0.879244955996861,0.877482202077271,0.875615772357144,0.873941695857369,0.873342967588726,0.871403035857026,0.869440022516153,0.868423641120720,0.867025067097190,0.866114092847471,0.863344701714527,0.862756025887297,0.860882233480677,0.859574469450559,0.857913377092696,0.856172140242258,0.855192478444463,0.852121576075518,0.850687688267161,0.849810380173203,0.848223430812386,0.846236443257129,0.844238265631173,0.843083071415346,0.841496892856864,0.839626050891016,0.838025850168679,0.836389733101832,0.834741335880731,0.832807679490313,0.830602746632074,0.829560785657163,0.827584198242670,0.825669189053937,0.824486630197048,0.822390696746099,0.820478478413084,0.818251392678231,0.816533293440912,0.814547296481109,0.813835357499849,0.810712487306470,0.807929344857538,0.808620730633782,0.805932288861344,0.803724801988596,0.802258698182565,0.799184173824592,0.797114591335077,0.796412243795050,0.794012432717646,0.791462706231870,0.789980744283621,0.787531401435604,0.785810081304295,0.783877752088135,0.782350823611089,0.780220188600390,0.778059896299894,0.775368297469561,0.774060873780193,0.771952755332258,0.770403082686508,0.767774169862296,0.765448890235137,0.763625559431739,0.761442304067126,0.758391365375017,0.757769047599008,0.755585729555252,0.753286958969791,0.749363927069310,0.747500457679686,0.745658888625376,0.745193661985021,0.742567623199120,0.739020317179033,0.737482414150116,0.734339256256666,0.732676790463780,0.729693860813152,0.728995157740740,0.725555849619760,0.722358485865124,0.721755442870046,0.719493969802493,0.717079988022424,0.714090548071853,0.712730618693940,0.709024679810876,0.707211030702796,0.705716879291842,0.701583514287918,0.700762627349180,0.696897380383134,0.695155361498557,0.692343968064999,0.690140015041422,0.687201234627993,0.685099439024674,0.683237307516190,0.679378743519733,0.676697217751422,0.674001900825449,0.672335987050586,0.669952829013333,0.666286433112118,0.663496021672585,0.660930788760072,0.659300610453045,0.655382108766645,0.653321184944922,0.652579460205032,0.648865842375836,0.644989572034498,0.644940302342913,0.640629589924763,0.636658376603049,0.635752339228870,0.631254459331205,0.627813797554683,0.625030817676050,0.623144856880170,0.620509399733579,0.616668242096830,0.614561093074053,0.612824918248479,0.608767180488994,0.605708025398540,0.601762386380402,0.598981717095115,0.595775890929345,0.592574257069877,0.591948795940253,0.588625083852903,0.583855329609944,0.581290146537288,0.577635015585597,0.574477862120630,0.573218123940727,0.568802227380361,0.564968096242013,0.562490694091528,0.559159056713535,0.555867868584773,0.554790640264492,0.549851642317631,0.545747319307974,0.542967191610625,0.540028510260328,0.536632088304594,0.532862077372155,0.531279734786697,0.525716914353891,0.523295757395659,0.521166541508424,0.515406455301546,0.512361872535233,0.509184214318631,0.505107324303811,0.503035568099778,0.498720789960925,0.495143782818721,0.490550476470273,0.487347689580096,0.482253839453003,0.479899809098889,0.476897251309528,0.473431921326824,0.469036851752404,0.465414234473180,0.462535826407501,0.454973983871180,0.452742498759017,0.448471832147205,0.444426373755240,0.439311027173924,0.439169392596456,0.432471442076963,0.426718396891275,0.421263204943700,0.418110726108148,0.416061247385975,0.411141133619181,0.406185544739415,0.402639565119094,0.397967523105986,0.396397471329280,0.392173573640130,0.382974403015627,0.381530367097976,0.374820879864944,0.368735920942598,0.366394329131111,0.359192230042291,0.355738338493664,0.350234778254899,0.349090357801730,0.341280824343829,0.337483660084640,0.330742680766728,0.324381694172311,0.318295865269125,0.312335558970133,0.305032437352712,0.302039837054228,0.295997519316454,0.287096101056554,0.281391565042716,0.274404467828488,0.266773890266534,0.261237688365023,0.252261747509465,0.240831976183453,0.228218784696634,0.221095425744745,0.212133008664357,0.197806809994514,0.173065518928985,0.0879605386363834,0.268780548282775,-0.0810212246611947,-0.137463657426126,0.344139293636554,0.223141915373705,-1.23813372408730,0.230200231568069,-0.0581616732727768,-0.00669610215429336,0.133440769223898,-0.0580643071861489,-0.0702149884200173,-0.744991444406833,0.238890065567736,0.0657197751974264,-8.29776891031666,-3.97987872054796,-14.3775439643975,0.0527064338376922,0.123491536993822,1.07363028407694,-2.39820601982674,-0.685325258352431,0.107696215705164,-3.79669624180747,0.198741886762200,0.104145853227951,0.0225156977056470,0.820772456953304,0.143043332040894,0.209369150567243,0.0896489884026993,0.168364677730701,0.0763171390140095,-0.106819938313827,0.00459442958994623,0.441032484710908,0.183637509340787,0.0253980495282987,0.142683130743628,-0.274726449716984,0.0818943530850160,0.625715683960106,0.0158104476810737,0.298728306509692,0.527468659104023,-0.216292856972757,0.106308458758240,0.0484001969658486,0.140089530651772,0.0301063471259631,-8.82373055516774,-0.0446347574462658,-0.821150681605042,0.109041647000970,0.112096358427489,-0.120427450375075,0.0395253108027044,0.521538596677094,0.0697866962548622,2.83118341100242,0.191008349411985,-0.0276768074553051,2.35541019787315,21.7435272872166,-0.170660452005313,-0.0128462541098870,0.0153490182956260,0.0198681335148826,1.71502681531628,0.484716688960750,0.0994672198737413,-0.00638960860113045,-0.254609403868382,-0.0553322434802974,-0.904102285379030,0.956568712535686,0.174119294036766,-0.0627297551909999,0.147371144166262,0.125523506319287,-0.275806921154164,0.180921680994232,0.129148783094842,0.00990029804194366,-0.416089404996533,-0.0243622812329493,0.179385582476169,1.23193717764759,-0.169817996356273,0.0470696712284672,0.203072994782181,-0.152738306978777,0.394089951016301,-0.208060958433418,0.0629881452734184,-0.589300055074556,-13.1130113874496,0.0676530098699736,-2.38746891783925,0.334357342434164,0.760423226307205,-0.489246296748661,-0.776671032660220,0.122005634150103,0.208454110722042,-2.23817285866623,1.59170874588707,-0.0691769392977718,-0.202732530510328,0.0945944055887698,-0.207882236986693,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
VolDE(VolDE<0)=0;
VolDE(VolDE>1)=1;
figure(106);clf

for i=2:numel(deadTime) 
    x = FnumCells(i,:)'*VolDE(i-1,:);
    subplot(1,numel(deadTime) -1,i-1)
    imagesc(x')
    ylim([0 500])
    caxis([0 5000])
    ylabel('Distance from Zero Order (\mum)')
    xlabel('Duration of Stimulation (ms)')
    colorbar
    axis square
end

%%
figure(108); clf
distList = [50 100 150 200 250];% 300 350 400 450 500];

for i = 2:numel(deadTime)
    s=i-1;
    subplot(1,3,s)
    hold on  
    for k= 1:numel(distList)
        plot(dur,FnumCells(i,:)*VolDE(s,distList(k)),'color',colors{i},'LineWidth',2)
    end
    ylim([0 5500])
    ylabel('Max Number of Spikeable Targets in 1 Second')
    xlabel('Stim Duration (ms)')
end


%% 1.7 comparison to number of Neurons in Volume

NeuronDensity = 87115;%S1-face neurons /mm3; Herculano-Houzel et al 2013

depthR=0.3; %depth range in mm 180um mean in our recordings
volume = (distList./1000*2).^2 .* depthR;
EstNumNeuron = volume.*NeuronDensity

    
%% 1.8 Other Opsins

param = 14;

switch param
    case 1
        % static spots C1V1 from Packer 2015
        LatM = 17.3;
        LatSTD = 0.7;
        
    case 2
        % sprial C1V1 from Packer 2015
        LatM = 21.4;
        LatSTD = 3.3;
        
    case 3
        % Holography Chronos from Ronzitti 2017 Pyramidals
        LatM = 6.4;
        LatSTD = 2.6;
        
    case 4
        % Holography Chronos INTERNEURONS from Ronzitti 2017
        LatM =2.83;
        LatSTD = 0.97;
        
    case 5
        % Holography CoChR INTERNEURONS from Ronzitti 2017
        LatM =4.76;
        LatSTD = 0.57;
        
    case 6
        % Holography ReachR pyramid from Chaigneau 2017 %note 10ms pulse
        LatM =28;
        LatSTD = 11;
        
    case 7
        % raster(?) c1v1 Paker 2012
        LatM = 58;
        LatSTD = 12;
    case 8
        %shemesh 2017 soCoChR Holography estimate made from graph not
        %written ('cortical neurons')
        LatM = 9.3;
        LatSTD = 4.04;
    case 9 
        %shemesh 2017 coChR see above disclaimer
        LatM = 10;
        LatSTD = 5.35;
    case 10 
        %us ST-C1V1
        LatM = 25.9;
        LatSTD = 4;
        
    case 11
        %Us ST-ChrimsonR
        LatM = 18.8;
        LatSTD = 3.8;
        
    case 12
        %us ST-Chronos
        LatM = 4.4;
        LatSTD = 0.65;
        
    case 13
        %us ST-ChroME (slice only
        LatM = 3.48;
        LatSTD = 0.49;
        
    case 14
        %hypothetical twice as fast
        LatM = 1.75;
        LatSTD = 0.49;
            
end

stDist = LatSTD.*randn(10000,1)+LatM;

% dur = 0:0.1:5;

pSpikeDist=sum((stDist<dur))./numel(stDist);

figure(103);clf
subplot(1,2,1)
plot(dur,pSpikeDist);
xlabel('Stim Duration (ms)')
ylabel('Probability of Spiking')

% numHolosPerFrame=50;
% deadTime=[0 3.3 33];
subplot(1,2,2)
hold on
for i=1:numel(deadTime)
 plot(dur,1000./(dur+deadTime(i)).*pSpikeDist*numHolosPerFrame,'color',colors{i})
end
xlabel('Stim Duration (ms)')
ylabel('Number of Spikeable Targets')

%% 1.9 Determine Diffraction Efficiency of hologram with N Targets

load('XYZ_Calibration.mat');

% LDMeadowlark
SLMCoordinatesCenter =   [0.5 0.5 -0.01];
SLMCoordinatesRange =    [0.4 0.4 0.04];
MaxNPts = 200;
MaxTrials = 10;
u = zeros(MaxTrials,MaxNPts);

for Npoints = 1:MaxNPts
    disp(Npoints)
    for trials = 1:MaxTrials
        SLMCoordinates = 2*(rand(3,Npoints)-0.5);
        for i = 1:Npoints
            SLMCoordinates(:,i) =SLMCoordinates(:,i).*SLMCoordinatesRange';
            SLMCoordinates(:,i) =SLMCoordinates(:,i)+SLMCoordinatesCenter';
        end
        AttenuationCoeffs = function_Power_Adjust( SLMCoordinates', COC );
        myattenuation = AttenuationCoeffs;
        energy = 1./myattenuation; energy = energy/sum(energy);
        u(trials, Npoints) = sum(energy.*myattenuation);
    end
end


f = figure(1)
plot(100*mean(u))
xlabel('Number of targets')
ylabel('Typical DE (Percent)')

Data.NumberOfTargets = 1:MaxNPts;
Data.Diffraction_Efficiency = 100*mean(u); 


       


